---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.1
  name: clusterinputs.fluentbit.fluent.io
spec:
  group: fluentbit.fluent.io
  names:
    kind: ClusterInput
    listKind: ClusterInputList
    plural: clusterinputs
    shortNames:
    - cfbi
    singular: clusterinput
  scope: Cluster
  versions:
  - name: v1alpha2
    schema:
      openAPIV3Schema:
        description: ClusterInput is the Schema for the inputs API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: InputSpec defines the desired state of ClusterInput
            properties:
              alias:
                description: |-
                  A user friendly alias name for this input plugin.
                  Used in metrics for distinction of each configured input.
                type: string
              collectd:
                description: Collectd defines the Collectd input plugin configuration
                properties:
                  listen:
                    description: 'Set the address to listen to, default: 0.0.0.0'
                    type: string
                  port:
                    description: 'Set the port to listen to, default: 25826'
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  typesDB:
                    description: 'Set the data specification file,default: /usr/share/collectd/types.db'
                    type: string
                type: object
              customPlugin:
                description: CustomPlugin defines Custom Input configuration.
                properties:
                  config:
                    type: string
                type: object
              dummy:
                description: Dummy defines Dummy Input configuration.
                properties:
                  dummy:
                    description: Dummy JSON record.
                    type: string
                  rate:
                    description: Events number generated per second.
                    format: int32
                    type: integer
                  samples:
                    description: Sample events to generate.
                    format: int32
                    type: integer
                  tag:
                    description: Tag name associated to all records comming from this
                      plugin.
                    type: string
                type: object
              fluentBitMetrics:
                description: FluentBitMetrics defines Fluent Bit Metrics Input configuration.
                properties:
                  scrapeInterval:
                    description: The rate at which metrics are collected from the
                      host operating system. default is 2 seconds.
                    type: string
                  scrapeOnStart:
                    description: Scrape metrics upon start, useful to avoid waiting
                      for 'scrape_interval' for the first round of metrics.
                    type: boolean
                  tag:
                    type: string
                type: object
              forward:
                description: Forward defines forward  input plugin configuration
                properties:
                  bufferMaxSize:
                    description: |-
                      Specify maximum buffer memory size used to recieve a forward message.
                      The value must be according to the Unit Size specification.
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  bufferchunkSize:
                    description: |-
                      Set the initial buffer size to store incoming data.
                      This value is used too to increase buffer size as required.
                      The value must be according to the Unit Size specification.
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  listen:
                    description: Listener network interface.
                    type: string
                  port:
                    description: Port for forward plugin instance.
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  tag:
                    description: in_forward uses the tag value for incoming logs.
                      If not set it uses tag from incoming log.
                    type: string
                  tagPrefix:
                    description: Adds the prefix to incoming event's tag
                    type: string
                  threaded:
                    description: Threaded mechanism allows input plugin to run in
                      a separate thread which helps to desaturate the main pipeline.
                    type: string
                  unixPath:
                    description: Specify the path to unix socket to recieve a forward
                      message. If set, Listen and port are ignnored.
                    type: string
                  unixPerm:
                    description: Set the permission of unix socket file.
                    type: string
                type: object
              http:
                description: HTTP defines the HTTP input plugin configuration
                properties:
                  bufferChunkSize:
                    description: |-
                      This sets the chunk size for incoming incoming JSON messages.
                      These chunks are then stored/managed in the space available by buffer_max_size,default 512K.
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  bufferMaxSize:
                    description: Specify the maximum buffer size in KB to receive
                      a JSON message,default 4M.
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  listen:
                    description: The address to listen on,default 0.0.0.0
                    type: string
                  port:
                    description: The port for Fluent Bit to listen on,default 9880
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  successfulHeader:
                    description: 'Add an HTTP header key/value pair on success. Multiple
                      headers can be set. Example: X-Custom custom-answer.'
                    type: string
                  successfulResponseCode:
                    description: It allows to set successful response code. 200, 201
                      and 204 are supported,default 201.
                    format: int32
                    type: integer
                  tagKey:
                    description: Specify the key name to overwrite a tag. If set,
                      the tag will be overwritten by a value of the key.
                    type: string
                  tls:
                    description: Fluent Bit provides integrated support for Transport
                      Layer Security (TLS) and it predecessor Secure Sockets Layer
                      (SSL) respectively.
                    properties:
                      caFile:
                        description: Absolute path to CA certificate file
                        type: string
                      caPath:
                        description: Absolute path to scan for certificate files
                        type: string
                      crtFile:
                        description: Absolute path to Certificate file
                        type: string
                      debug:
                        description: |-
                          Set TLS debug verbosity level.
                          It accept the following values: 0 (No debug), 1 (Error), 2 (State change), 3 (Informational) and 4 Verbose
                        enum:
                        - 0
                        - 1
                        - 2
                        - 3
                        - 4
                        format: int32
                        type: integer
                      keyFile:
                        description: Absolute path to private Key file
                        type: string
                      keyPassword:
                        description: Optional password for tls.key_file file
                        properties:
                          valueFrom:
                            description: ValueSource defines how to find a value's
                              key.
                            properties:
                              secretKeyRef:
                                description: Selects a key of a secret in the pod's
                                  namespace
                                properties:
                                  key:
                                    description: The key of the secret to select from.  Must
                                      be a valid secret key.
                                    type: string
                                  name:
                                    default: ""
                                    description: |-
                                      Name of the referent.
                                      This field is effectively required, but due to backwards compatibility is
                                      allowed to be empty. Instances of this type with an empty value here are
                                      almost certainly wrong.
                                      More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                                    type: string
                                  optional:
                                    description: Specify whether the Secret or its
                                      key must be defined
                                    type: boolean
                                required:
                                - key
                                type: object
                                x-kubernetes-map-type: atomic
                            type: object
                        type: object
                      verify:
                        description: Force certificate validation
                        type: boolean
                      vhost:
                        description: Hostname to be used for TLS SNI extension
                        type: string
                    type: object
                type: object
              logLevel:
                enum:
                - "off"
                - error
                - warning
                - info
                - debug
                - trace
                type: string
              mqtt:
                description: MQTT defines the MQTT input plugin configuration
                properties:
                  listen:
                    description: 'Listener network interface, default: 0.0.0.0'
                    type: string
                  port:
                    description: 'TCP port where listening for connections, default:
                      1883'
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                type: object
              nginx:
                description: Nginx defines the Nginx input plugin configuration
                properties:
                  host:
                    description: 'Name of the target host or IP address to check,
                      default: localhost'
                    type: string
                  nginxPlus:
                    description: 'Turn on NGINX plus mode,default: true'
                    type: boolean
                  port:
                    description: 'Port of the target nginx service to connect to,
                      default: 80'
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  statusURL:
                    description: 'The URL of the Stub Status Handler,default: /status'
                    type: string
                type: object
              nodeExporterMetrics:
                description: NodeExporterMetrics defines Node Exporter Metrics Input
                  configuration.
                properties:
                  path:
                    properties:
                      procfs:
                        description: The mount point used to collect process information
                          and metrics.
                        type: string
                      sysfs:
                        description: The path in the filesystem used to collect system
                          metrics.
                        type: string
                    type: object
                  scrapeInterval:
                    description: The rate at which metrics are collected from the
                      host operating system, default is 5 seconds.
                    type: string
                  tag:
                    description: Tag name associated to all records comming from this
                      plugin.
                    type: string
                type: object
              openTelemetry:
                description: OpenTelemetry defines the OpenTelemetry input plugin
                  configuration
                properties:
                  bufferChunkSize:
                    description: This sets the chunk size for incoming incoming JSON
                      messages. These chunks are then stored/managed in the space
                      available by buffer_max_size(default 512K).
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  bufferMaxSize:
                    description: Specify the maximum buffer size in KB to receive
                      a JSON message(default 4M).
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  listen:
                    description: The address to listen on,default 0.0.0.0
                    type: string
                  port:
                    description: The port for Fluent Bit to listen on.default 4318.
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  rawTraces:
                    description: Route trace data as a log message(default false).
                    type: boolean
                  successfulResponseCode:
                    description: It allows to set successful response code. 200, 201
                      and 204 are supported(default 201).
                    format: int32
                    type: integer
                  tagKey:
                    description: Specify the key name to overwrite a tag. If set,
                      the tag will be overwritten by a value of the key.
                    type: string
                type: object
              prometheusScrapeMetrics:
                description: PrometheusScrapeMetrics  defines Prometheus Scrape Metrics
                  Input configuration.
                properties:
                  host:
                    description: The host of the prometheus metric endpoint that you
                      want to scrape
                    type: string
                  metricsPath:
                    description: 'The metrics URI endpoint, that must start with a
                      forward slash, deflaut: /metrics'
                    type: string
                  port:
                    description: The port of the promethes metric endpoint that you
                      want to scrape
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  scrapeInterval:
                    description: 'The interval to scrape metrics, default: 10s'
                    type: string
                  tag:
                    description: Tag name associated to all records comming from this
                      plugin
                    type: string
                type: object
              statsd:
                description: StatsD defines the StatsD input plugin configuration
                properties:
                  listen:
                    description: 'Listener network interface, default: 0.0.0.0'
                    type: string
                  port:
                    description: 'UDP port where listening for connections, default:
                      8125'
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                type: object
              syslog:
                description: Syslog defines the Syslog input plugin configuration
                properties:
                  bufferChunkSize:
                    description: |-
                      By default the buffer to store the incoming Syslog messages, do not allocate the maximum memory allowed, instead it allocate memory when is required.
                      The rounds of allocations are set by Buffer_Chunk_Size. If not set, Buffer_Chunk_Size is equal to 32000 bytes (32KB).
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  bufferMaxSize:
                    description: Specify the maximum buffer size to receive a Syslog
                      message. If not set, the default size will be the value of Buffer_Chunk_Size.
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  listen:
                    description: 'If Mode is set to tcp or udp, specify the network
                      interface to bind, default: 0.0.0.0'
                    type: string
                  mode:
                    description: 'Defines transport protocol mode: unix_udp (UDP over
                      Unix socket), unix_tcp (TCP over Unix socket), tcp or udp'
                    enum:
                    - unix_udp
                    - unix_tcp
                    - tcp
                    - udp
                    type: string
                  parser:
                    description: |-
                      Specify an alternative parser for the message. If Mode is set to tcp or udp then the default parser is syslog-rfc5424 otherwise syslog-rfc3164-local is used.
                      If your syslog messages have fractional seconds set this Parser value to syslog-rfc5424 instead.
                    type: string
                  path:
                    description: If Mode is set to unix_tcp or unix_udp, set the absolute
                      path to the Unix socket file.
                    type: string
                  port:
                    description: If Mode is set to tcp or udp, specify the TCP port
                      to listen for incoming connections.
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  receiveBufferSize:
                    description: |-
                      Specify the maximum socket receive buffer size. If not set, the default value is OS-dependant,
                      but generally too low to accept thousands of syslog messages per second without loss on udp or unix_udp sockets. Note that on Linux the value is capped by sysctl net.core.rmem_max.
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  sourceAddressKey:
                    description: Specify the key where the source address will be
                      injected.
                    type: string
                  unixPerm:
                    description: 'If Mode is set to unix_tcp or unix_udp, set the
                      permission of the Unix socket file, default: 0644'
                    format: int32
                    type: integer
                type: object
              systemd:
                description: Systemd defines Systemd Input configuration.
                properties:
                  db:
                    description: Specify the database file to keep track of monitored
                      files and offsets.
                    type: string
                  dbSync:
                    description: |-
                      Set a default synchronization (I/O) method. values: Extra, Full, Normal, Off.
                      This flag affects how the internal SQLite engine do synchronization to disk,
                      for more details about each option please refer to this section.
                      note: this option was introduced on Fluent Bit v1.4.6.
                    enum:
                    - Extra
                    - Full
                    - Normal
                    - "Off"
                    type: string
                  maxEntries:
                    description: |-
                      When Fluent Bit starts, the Journal might have a high number of logs in the queue.
                      In order to avoid delays and reduce memory usage, this option allows to specify the maximum number of log entries that can be processed per round.
                      Once the limit is reached, Fluent Bit will continue processing the remaining log entries once Journald performs the notification.
                    type: integer
                  maxFields:
                    description: Set a maximum number of fields (keys) allowed per
                      record.
                    type: integer
                  path:
                    description: |-
                      Optional path to the Systemd journal directory,
                      if not set, the plugin will use default paths to read local-only logs.
                    type: string
                  pauseOnChunksOverlimit:
                    description: Specifies if the input plugin should be paused (stop
                      ingesting new data) when the storage.max_chunks_up value is
                      reached.
                    enum:
                    - "on"
                    - "off"
                    type: string
                  readFromTail:
                    description: Start reading new entries. Skip entries already stored
                      in Journald.
                    enum:
                    - "on"
                    - "off"
                    type: string
                  storageType:
                    description: Specify the buffering mechanism to use. It can be
                      memory or filesystem
                    enum:
                    - filesystem
                    - memory
                    type: string
                  stripUnderscores:
                    description: Remove the leading underscore of the Journald field
                      (key). For example the Journald field _PID becomes the key PID.
                    enum:
                    - "on"
                    - "off"
                    type: string
                  systemdFilter:
                    description: |-
                      Allows to perform a query over logs that contains a specific Journald key/value pairs, e.g: _SYSTEMD_UNIT=UNIT.
                      The Systemd_Filter option can be specified multiple times in the input section to apply multiple filters as required.
                    items:
                      type: string
                    type: array
                  systemdFilterType:
                    description: |-
                      Define the filter type when Systemd_Filter is specified multiple times. Allowed values are And and Or.
                      With And a record is matched only when all of the Systemd_Filter have a match.
                      With Or a record is matched when any of the Systemd_Filter has a match.
                    enum:
                    - And
                    - Or
                    type: string
                  tag:
                    description: |-
                      The tag is used to route messages but on Systemd plugin there is an extra functionality:
                      if the tag includes a star/wildcard, it will be expanded with the Systemd Unit file (e.g: host.* => host.UNIT_NAME).
                    type: string
                type: object
              tail:
                description: Tail defines Tail Input configuration.
                properties:
                  bufferChunkSize:
                    description: |-
                      Set the initial buffer size to read files data.
                      This value is used too to increase buffer size.
                      The value must be according to the Unit Size specification.
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  bufferMaxSize:
                    description: |-
                      Set the limit of the buffer size per monitored file.
                      When a buffer needs to be increased (e.g: very long lines),
                      this value is used to restrict how much the memory buffer can grow.
                      If reading a file exceed this limit, the file is removed from the monitored file list
                      The value must be according to the Unit Size specification.
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  db:
                    description: Specify the database file to keep track of monitored
                      files and offsets.
                    type: string
                  dbSync:
                    description: 'Set a default synchronization (I/O) method. Values:
                      Extra, Full, Normal, Off.'
                    enum:
                    - Extra
                    - Full
                    - Normal
                    - "Off"
                    type: string
                  disableInotifyWatcher:
                    description: DisableInotifyWatcher will disable inotify and use
                      the file stat watcher instead.
                    type: boolean
                  dockerMode:
                    description: |-
                      If enabled, the plugin will recombine split Docker log lines before passing them to any parser as configured above.
                      This mode cannot be used at the same time as Multiline.
                    type: boolean
                  dockerModeFlushSeconds:
                    description: Wait period time in seconds to flush queued unfinished
                      split lines.
                    format: int64
                    type: integer
                  dockerModeParser:
                    description: Specify an optional parser for the first line of
                      the docker multiline mode. The parser name to be specified must
                      be registered in the parsers.conf file.
                    type: string
                  excludePath:
                    description: |-
                      Set one or multiple shell patterns separated by commas to exclude files matching a certain criteria,
                      e.g: exclude_path=*.gz,*.zip
                    type: string
                  ignoredOlder:
                    description: |-
                      Ignores records which are older than this time in seconds.
                      Supports m,h,d (minutes, hours, days) syntax.
                      Default behavior is to read all records from specified files.
                      Only available when a Parser is specificied and it can parse the time of a record.
                    pattern: ^\d+(m|h|d)?$
                    type: string
                  key:
                    description: |-
                      When a message is unstructured (no parser applied), it's appended as a string under the key name log.
                      This option allows to define an alternative name for that key.
                    type: string
                  memBufLimit:
                    description: |-
                      Set a limit of memory that Tail plugin can use when appending data to the Engine.
                      If the limit is reach, it will be paused; when the data is flushed it resumes.
                    type: string
                  multiline:
                    description: |-
                      If enabled, the plugin will try to discover multiline messages
                      and use the proper parsers to compose the outgoing messages.
                      Note that when this option is enabled the Parser option is not used.
                    type: boolean
                  multilineFlushSeconds:
                    description: Wait period time in seconds to process queued multiline
                      messages
                    format: int64
                    type: integer
                  multilineParser:
                    description: |-
                      This will help to reassembly multiline messages originally split by Docker or CRI
                      Specify one or Multiline Parser definition to apply to the content.
                    type: string
                  parser:
                    description: Specify the name of a parser to interpret the entry
                      as a structured message.
                    type: string
                  parserFirstline:
                    description: |-
                      Name of the parser that matchs the beginning of a multiline message.
                      Note that the regular expression defined in the parser must include a group name (named capture)
                    type: string
                  parserN:
                    description: |-
                      Optional-extra parser to interpret and structure multiline entries.
                      This option can be used to define multiple parsers.
                    items:
                      type: string
                    type: array
                  path:
                    description: Pattern specifying a specific log files or multiple
                      ones through the use of common wildcards.
                    type: string
                  pathKey:
                    description: |-
                      If enabled, it appends the name of the monitored file as part of the record.
                      The value assigned becomes the key in the map.
                    type: string
                  pauseOnChunksOverlimit:
                    description: Specifies if the input plugin should be paused (stop
                      ingesting new data) when the storage.max_chunks_up value is
                      reached.
                    enum:
                    - "on"
                    - "off"
                    type: string
                  readFromHead:
                    description: |-
                      For new discovered files on start (without a database offset/position),
                      read the content from the head of the file, not tail.
                    type: boolean
                  refreshIntervalSeconds:
                    description: The interval of refreshing the list of watched files
                      in seconds.
                    format: int64
                    type: integer
                  rotateWaitSeconds:
                    description: Specify the number of extra time in seconds to monitor
                      a file once is rotated in case some pending data is flushed.
                    format: int64
                    type: integer
                  skipLongLines:
                    description: |-
                      When a monitored file reach it buffer capacity due to a very long line (Buffer_Max_Size),
                      the default behavior is to stop monitoring that file.
                      Skip_Long_Lines alter that behavior and instruct Fluent Bit to skip long lines
                      and continue processing other lines that fits into the buffer size.
                    type: boolean
                  storageType:
                    description: Specify the buffering mechanism to use. It can be
                      memory or filesystem
                    enum:
                    - filesystem
                    - memory
                    type: string
                  tag:
                    description: |-
                      Set a tag (with regex-extract fields) that will be placed on lines read.
                      E.g. kube.<namespace_name>.<pod_name>.<container_name>
                    type: string
                  tagRegex:
                    description: Set a regex to exctract fields from the file
                    type: string
                type: object
              tcp:
                description: TCP defines the TCP input plugin configuration
                properties:
                  bufferSize:
                    description: Specify the maximum buffer size in KB to receive
                      a JSON message. If not set, the default size will be the value
                      of Chunk_Size.
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  chunkSize:
                    description: |-
                      By default the buffer to store the incoming JSON messages, do not allocate the maximum memory allowed, instead it allocate memory when is required.
                      The rounds of allocations are set by Chunk_Size in KB. If not set, Chunk_Size is equal to 32 (32KB).
                    pattern: ^\d+(k|K|KB|kb|m|M|MB|mb|g|G|GB|gb)?$
                    type: string
                  format:
                    description: |-
                      Specify the expected payload format. It support the options json and none.
                      When using json, it expects JSON maps, when is set to none, it will split every record using the defined Separator (option below).
                    type: string
                  listen:
                    description: Listener network interface,default 0.0.0.0
                    type: string
                  port:
                    description: TCP port where listening for connections,default
                      5170
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  separator:
                    description: When the expected Format is set to none, Fluent Bit
                      needs a separator string to split the records. By default it
                      uses the breakline character (LF or 0x10).
                    type: string
                type: object
            type: object
        type: object
    served: true
    storage: true
