apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component

resources:
- secretbinding.yaml
- credentialsbinding.yaml

secretGenerator:
# Instead of creating an empty "cloudprovider" secret, we create a secret containing the kubeconfig
# for the local kind cluster. If the kubeconfig key in the cloudprovider secret is present, provider-local
# uses it to manage infrastructure resources instead of using its in-cluster ServiceAccount.
# See docs/extensions/provider-local.md#credentials for details.
# This is only needed for self-hosted shoots in the local setup because provider-local needs to manage
# Kubernetes resources in a different cluster than the one it is running in.
# Most notably, putting the initial kind cluster kubeconfig into the cloudprovider secret will effectively
# prevent a control plane migration to another kind cluster in the local setup.
# The kubeconfig file is copied to this directory by hack/kind-up.sh.
- name: local
  namespace: garden
  options:
    disableNameSuffixHash: true
  files:
  - kubeconfig
